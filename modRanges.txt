Option Explicit

Function GetColumnNumber(sColumnName As String) As Long

'#### Input is a column name like A or BZ, the output is the column number that matches the column name lile 1 or 78

    Dim lResult As Long

    If Len(sColumnName) = 1 Then
        ' If the column name is only a single character it is trivial to determine the result using ASCII codes (A=65, etc)
        lResult = Asc(sColumnName) - 64
    Else
        ' If the column name is more than one character (eg: XFD the current max allowed) we determine the number indicated
        ' by the character in the first position and then recursively call the function with the remaining characters
        ' For example if the address is CA we first determine that the value indicated by the C is 78 and then add the value
        ' given by A which is 1 for a result of 79
        lResult = 26 ^ (Len(sColumnName) - 1) * GetColumnNumber(Left(sColumnName, 1)) + GetColumnNumber(Right(sColumnName, Len(sColumnName) - 1))
    End If

    GetColumnNumber = lResult

End Function
